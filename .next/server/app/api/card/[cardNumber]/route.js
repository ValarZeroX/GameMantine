(()=>{var e={};e.id=8131,e.ids=[8131],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},79348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},97528:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>k,routeModule:()=>d,serverHooks:()=>f,workAsyncStorage:()=>_,workUnitAsyncStorage:()=>m});var a={};r.r(a),r.d(a,{GET:()=>p});var s=r(52412),n=r(14293),i=r(94147),l=r(77856),c=r(3089);let u=e=>{if(e)return e.includes(",")?e.split(","):isNaN(Number(e))?[e]:[Number(e)]},o=e=>{let t=e;return(t=(t=t.replace(/,\s*}/g,"}").replace(/,\s*]/g,"]")).replace(/([{,]\s*)(\d+)\s*:/g,'$1"$2":')).replace(/'([^']*)'/g,'"$1"')};async function p(e,{params:t}){let{cardNumber:r}=await t;try{let e=await c._.card.findUnique({where:{number:r}});if(!e)return l.NextResponse.json({error:"卡片不存在。"},{status:404});let t={...e,dex:u(e.dex),attack_aspects_1:u(e.attack_aspects_1),attack_aspects_2:u(e.attack_aspects_2)??void 0,retreat_aspects:u(e.retreat_aspects),reprints:{},attack_skill_1:e.attack_skill_1??null,attack_skill_name_1:e.attack_skill_name_1??null,attack_skill_2:e.attack_skill_2??null,attack_skill_name_2:e.attack_skill_name_2??null,ability_name:e.ability_name??null,ability_directions:e.ability_directions??null,rule:e.rule??null,attack_2:e.attack_2??null};if(e.reprints){let r;if("string"==typeof e.reprints)try{let t=o(e.reprints);r=JSON.parse(t)}catch(e){r={}}else r="object"==typeof e.reprints?e.reprints:{};let a=Object.keys(r),s=[];a.forEach(e=>{s.push(...r[e])});let n=Array.from(new Set(s));if(n.length>0){let e=await c._.card.findMany({where:{name:{in:n}},select:{name:!0,number:!0}}),s={};e.forEach(e=>{s[e.name]||(s[e.name]=[]),s[e.name].push(e.number)}),a.forEach(e=>{let a=[];r[e].forEach(e=>{s[e]&&a.push(...s[e])}),t.reprints[e]=a})}}return l.NextResponse.json(t,{status:200})}catch(e){return l.NextResponse.json({error:"無法取得卡片資料。"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/card/[cardNumber]/route",pathname:"/api/card/[cardNumber]",filename:"route",bundlePath:"app/api/card/[cardNumber]/route"},resolvedPagePath:"D:\\MyCode\\GameMantine\\app\\api\\card\\[cardNumber]\\route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:_,workUnitAsyncStorage:m,serverHooks:f}=d;function k(){return(0,i.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:m})}},35303:()=>{},3089:(e,t,r)=>{"use strict";r.d(t,{_:()=>s});var a=r(53524);let s=global.prisma||new a.PrismaClient({log:["query","info","warn","error"]})},21152:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ReflectAdapter",{enumerable:!0,get:function(){return r}});class r{static get(e,t,r){let a=Reflect.get(e,t,r);return"function"==typeof a?a.bind(e):a}static set(e,t,r,a){return Reflect.set(e,t,r,a)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[4147,8814],()=>r(97528));module.exports=a})();