(()=>{var e={};e.id=493,e.ids=[493],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},79348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},53655:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>v,routeModule:()=>_,serverHooks:()=>y,workAsyncStorage:()=>k,workUnitAsyncStorage:()=>m});var a={};r.r(a),r.d(a,{GET:()=>d,POST:()=>l});var s=r(52412),n=r(14293),i=r(94147),c=r(77856),o=r(3089);let u=e=>e&&0!==e.length?e.join(","):null,p=e=>{if(!e)return null;let t=e.split(",");return t.every(e=>!isNaN(Number(e)))?t.map(e=>Number(e)):t};async function l(e){try{let t=await e.json();if(!t.number||!t.set||!t.dex||void 0===t.rarity||!t.name||void 0===t.type||void 0===t.stage||void 0===t.hp||void 0===t.aspects||void 0===t.attack_1||!t.attack_aspects_1||void 0===t.retreat||!t.retreat_aspects||void 0===t.weakness||void 0===t.weakness_value||!t.illustrator||void 0===t.point)return c.NextResponse.json({error:"所有必要欄位都是必填的。"},{status:400});if(await o._.card.findUnique({where:{number:t.number}}))return c.NextResponse.json({error:"卡片編號已存在。"},{status:400});let r=await o._.card.create({data:{number:t.number,set:t.set,dex:u(t.dex)||"",rarity:t.rarity,name:t.name,type:t.type,stage:t.stage,hp:t.hp,aspects:t.aspects,illustrator:t.illustrator,point:t.point,rule:t.rule||"",attack_1:t.attack_1,attack_name_1:t.attack_name_1,attack_aspects_1:u(t.attack_aspects_1)||"",attack_skill_name_1:t.attack_skill_name_1||"",attack_2:t.attack_2||null,attack_name_2:t.attack_name_2||"",attack_aspects_2:t.attack_aspects_2?u(t.attack_aspects_2):null,attack_skill_name_2:t.attack_skill_name_2||"",ability_name:t.ability_name||"",ability_directions:t.ability_directions||"",ability:t.ability||null,retreat:t.retreat,retreat_aspects:u(t.retreat_aspects)||"",weakness:t.weakness,weakness_value:t.weakness_value,...t.reprints?{reprints:t.reprints}:{}}});return c.NextResponse.json({message:"卡片創建成功！",card:r},{status:201})}catch(e){return console.error("Error creating card:",e),c.NextResponse.json({error:"卡片創建失敗。"},{status:500})}}async function d(e){try{let t=new URL(e.url).searchParams.get("sets"),r={};t&&(r={set:{in:t.split(",")}});let a=(await o._.card.findMany({where:r,orderBy:{number:"asc"}})).map(e=>({...e,dex:p(e.dex),attack_aspects_1:p(e.attack_aspects_1),attack_aspects_2:p(e.attack_aspects_2||null),retreat_aspects:p(e.retreat_aspects),reprints:e.reprints?e.reprints:null}));return c.NextResponse.json(a,{status:200})}catch(e){return console.error("Error fetching cards:",e),c.NextResponse.json({error:"無法取得卡片資料。"},{status:500})}}let _=new s.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/card/route",pathname:"/api/card",filename:"route",bundlePath:"app/api/card/route"},resolvedPagePath:"D:\\MyCode\\GameMantine\\app\\api\\card\\route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:k,workUnitAsyncStorage:m,serverHooks:y}=_;function v(){return(0,i.patchFetch)({workAsyncStorage:k,workUnitAsyncStorage:m})}},35303:()=>{},3089:(e,t,r)=>{"use strict";r.d(t,{_:()=>s});var a=r(53524);let s=global.prisma||new a.PrismaClient({log:["query","info","warn","error"]})},21152:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ReflectAdapter",{enumerable:!0,get:function(){return r}});class r{static get(e,t,r){let a=Reflect.get(e,t,r);return"function"==typeof a?a.bind(e):a}static set(e,t,r,a){return Reflect.set(e,t,r,a)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[4147,8814],()=>r(53655));module.exports=a})();