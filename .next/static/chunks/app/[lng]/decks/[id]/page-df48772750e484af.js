(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8439],{95700:(e,o,n)=>{var i={"./en/ability.json":[13330,3330],"./en/common.json":[17056,7056],"./en/pokemon.json":[91013,1013],"./en/rule.json":[95481,5481],"./en/skill.json":[60976,976],"./zh-Hans/ability.json":[52326,2326],"./zh-Hans/common.json":[81775,1775],"./zh-Hans/pokemon.json":[66345,6345],"./zh-Hans/rule.json":[74806,4806],"./zh-Hans/skill.json":[69867,9867],"./zh-Hant/ability.json":[72975,2975],"./zh-Hant/common.json":[72349,2349],"./zh-Hant/pokemon.json":[86185,6185],"./zh-Hant/rule.json":[97637,7637],"./zh-Hant/skill.json":[1701,1701]};function t(e){if(!n.o(i,e))return Promise.resolve().then(()=>{var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o});var o=i[e],t=o[0];return n.e(o[1]).then(()=>n.t(t,19))}t.keys=()=>Object.keys(i),t.id=95700,e.exports=t},34614:(e,o,n)=>{Promise.resolve().then(n.bind(n,28003)),Promise.resolve().then(n.bind(n,85393))},28003:(e,o,n)=>{"use strict";n.d(o,{default:()=>A});var i=n(57437),t=n(2265),s=n(1597),r=n(22281),a=n(1959),c=n(41707),l=n(99763),d=n(86608),m=n(7497),u=n(35671),h=n(49309),g=n(99075),j=n(70132),p=n(96293),f=n(83184),x=n(71719),k=n(40665),b=n(91601),v=n(85254),_=n(22966),w=n(29056),y=n(45896),z=n(47834),Z=n(11620),C=n(98953),S=n(87138),E=n(47025),O=n(81173),H=n.n(O),R=n(30998),T=n(60327),L=n(16463),N=n(81822);let A=e=>{let{lng:o}=e,{data:n}=(0,R.useSession)(),{t:O}=(0,E.$)(o,["pokemon","common","skill","ability","rule"]),[A,F]=(0,t.useState)(null),[D,P]=(0,t.useState)(!0),[I,U]=(0,t.useState)([]),[B,M]=(0,t.useState)(null),[W,G]=(0,t.useState)(!1),[V,$]=(0,t.useState)(0),[J,Y]=(0,t.useState)(""),[q,K]=(0,t.useState)(!1),[X,Q]=(0,t.useState)(0),[ee,eo]=(0,t.useState)(0),{id:en}=(0,L.useParams)(),{colorScheme:ei}=(0,s.X)(),et=(0,t.useRef)(null);(0,t.useEffect)(()=>{var e;if(null==n?void 0:null===(e=n.user)||void 0===e?void 0:e.id){if(!en||Array.isArray(en)){M(O("common:notification.error_invalid_id")),P(!1);return}(async()=>{try{let e=await fetch("/api/decks/".concat(en),{method:"GET",credentials:"include"});if(!e.ok){let o=await e.json();M(o.message||O("common:notification.error_fetch_deck")),P(!1);return}let o=await e.json();G(o.isSaved),P(!1)}catch(e){console.error("Error fetching Deck:",e),P(!1)}})()}},[en,O]),(0,t.useEffect)(()=>{if(!en||Array.isArray(en)){M(O("common:notification.error_invalid_id")),P(!1);return}(async()=>{try{let e=await fetch("/api/decks/user/".concat(en),{method:"GET",credentials:"include"});if(!e.ok){let o=await e.json();M(o.message||O("common:notification.error_fetch_deck")),P(!1);return}let o=await e.json();F(o.deck);let n=o.deck.deckCards.split(",").map(e=>{let n=o.cards.find(o=>o.number===e.trim());return n?{...n}:null}).filter(e=>null!==e);U(n),P(!1)}catch(e){console.error("Error fetching Deck:",e),M(O("common:notification.error_fetch_deck")),P(!1)}})()},[en,O]);let es=(0,t.useMemo)(()=>{let e={pokemon:0,item:0,supporter:0};return I.forEach(o=>{0===o.type?e.pokemon+=1:1===o.type?e.item+=1:2===o.type&&(e.supporter+=1)}),e},[I]),er=(0,t.useMemo)(()=>({pokemon:5*es.pokemon,item:5*es.item,supporter:5*es.supporter}),[es]),ea=(0,t.useMemo)(()=>I.reduce((e,o)=>e+N.pt[o.rarity],0),[I,N.pt]),ec=async()=>{if(!(null==n?void 0:n.user)){(0,T.c0)({title:O("common:notification.error_not_logged_in"),message:O("common:notification.error_please_login"),color:"red",icon:(0,i.jsx)(_.Z,{size:16})});return}try{let e=await fetch("/api/decks/".concat(en),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({deckCards:I,deckName:O("common:notification.notification_unnamed")})}),o=await e.json();e.ok?((0,T.c0)({title:O("common:notification.success"),message:O("common:notification.success_deck_saved"),color:"green",icon:(0,i.jsx)(w.Z,{size:16})}),G(!0)):(0,T.c0)({title:O("common:notification.error"),message:o.message||O("common:notification.error_save_deck_failed"),color:"red",icon:(0,i.jsx)(_.Z,{size:16})})}catch(e){(0,T.c0)({title:O("common:notification.error"),message:O("common:notification.error_save_deck"),color:"red",icon:(0,i.jsx)(_.Z,{size:16})})}finally{P(!1)}},el=async()=>{if(!(null==n?void 0:n.user)){(0,T.c0)({title:O("common:notification.error_not_logged_in"),message:O("common:notification.error_please_login"),color:"red",icon:(0,i.jsx)(_.Z,{size:16})});return}try{let e=await fetch("/api/decks/".concat(en),{method:"DELETE",headers:{"Content-Type":"application/json"}}),o=await e.json();e.ok?((0,T.c0)({title:O("common:notification.success"),message:O("common:notification.success_deck_deleted"),color:"green",icon:(0,i.jsx)(w.Z,{size:16})}),G(!1)):(0,T.c0)({title:O("common:notification.error_title"),message:o.message||O("common:notification.error_delete_deck_failed"),color:"red",icon:(0,i.jsx)(_.Z,{size:16})})}catch(e){(0,T.c0)({title:O("common:notification.error_title"),message:O("common:notification.error_delete_deck"),color:"red",icon:(0,i.jsx)(_.Z,{size:16})})}finally{P(!1)}},ed=async()=>{if(!(null==n?void 0:n.user)){(0,T.c0)({title:O("common:notification.error_not_logged_in"),message:O("common:notification.error_please_login"),color:"red",icon:(0,i.jsx)(_.Z,{size:16})});return}K(!0);try{let e=await fetch("/api/decks/".concat(en,"/rating"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rating:V,comment:J})}),o=await e.json();e.ok?((0,T.c0)({title:O("common:notification.success"),message:"您的評分已提交",color:"green",icon:(0,i.jsx)(w.Z,{size:16})}),$(0),Y("")):(0,T.c0)({title:O("common:notification.error_title"),message:o.message||"提交評分時出錯",color:"red",icon:(0,i.jsx)(_.Z,{size:16})})}catch(e){console.error("Error submitting rating:",e),(0,T.c0)({title:O("common:notification.error_title"),message:"提交評分時發生伺服器錯誤",color:"red",icon:(0,i.jsx)(_.Z,{size:16})})}finally{K(!1)}};(0,t.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/decks/".concat(en,"/rating")),o=await e.json();e.ok?(Q(o.averageRating),eo(o.ratingCount)):console.error(o.message)}catch(e){}finally{P(!1)}})()},[en]);let em=async()=>{if(et.current){let e=et.current.cloneNode(!0);e.style.backgroundColor="dark"===ei?"#242424":"#FFFFFF",document.body.appendChild(e);let o=await H()(e,{backgroundColor:null,useCORS:!0});document.body.removeChild(e);let n=o.toDataURL("image/png"),i=document.createElement("a");i.href=n,i.download="pokemonnier.png",i.click()}},eu=[{title:O("common:navigation.home"),href:"/"},{title:O("common:navigation.deck_list"),href:"/decks/list"},{title:O("common:navigation.deck"),href:"#"}].map((e,o)=>(0,i.jsx)(r.e,{href:e.href,children:e.title},o));return(0,i.jsxs)(a.W,{size:"lg",children:[(0,i.jsx)(c.O,{children:eu}),(0,i.jsxs)(l.Title,{order:1,mt:"md",children:[en," - ",O("common:navigation.deck")]}),(0,i.jsxs)(d.Z,{mt:"md",justify:"flex-end",children:[(0,i.jsx)(m.A,{variant:"default",size:"lg",onClick:em,children:(0,i.jsx)(y.Z,{})}),W?(0,i.jsx)(m.A,{variant:"default",size:"lg",onClick:el,loading:D,children:(0,i.jsx)(z.Z,{color:"#fcc419"})}):(0,i.jsx)(m.A,{variant:"default",size:"lg",onClick:ec,loading:D,children:(0,i.jsx)(Z.Z,{color:"#fcc419"})})]}),(0,i.jsxs)("div",{ref:et,children:[(0,i.jsx)(u.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,mt:"md",children:(0,i.jsx)(h.r,{columns:10,children:I.map((e,n)=>(0,i.jsxs)(h.r.Col,{span:{base:2,sm:2,md:1,lg:1},children:[(0,i.jsx)(S.default,{href:"/".concat(o,"/cards/").concat(e.number),passHref:!0,style:{textDecoration:"none"},children:(0,i.jsx)(g.E,{radius:"md",src:"/".concat(o,"/").concat(e.set,"/").concat(e.number,".webp"),alt:"".concat(e.number)})}),(0,i.jsxs)(j.K,{mt:"md",align:"center",gap:"xs",children:[(0,i.jsx)(p.Text,{fw:700,size:"xs",children:O("pokemon:".concat(e.name))}),(0,i.jsx)(p.Text,{c:"dimmed",size:"xs",children:e.number})]})]},"".concat(en,"-").concat(e.set,"-").concat(e.number,"-").concat(n)))})}),(0,i.jsx)(h.r,{mt:"md",children:(0,i.jsx)(h.r.Col,{span:12,children:(0,i.jsxs)(u.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[(0,i.jsxs)(d.Z,{mb:"md",children:[(0,i.jsx)(f.C,{color:"cyan",variant:"filled",children:O("common:pokemon")}),(0,i.jsx)(f.C,{color:"pink",variant:"filled",children:O("common:item")}),(0,i.jsx)(f.C,{color:"orange",variant:"filled",children:O("common:supporter")})]}),(0,i.jsxs)(x.E.Root,{size:"20",children:[(0,i.jsx)(x.E.Section,{value:er.pokemon,color:"cyan",children:(0,i.jsx)(x.E.Label,{children:es.pokemon})}),(0,i.jsx)(x.E.Section,{value:er.item,color:"pink",children:(0,i.jsx)(x.E.Label,{children:es.item})}),(0,i.jsx)(x.E.Section,{value:er.supporter,color:"orange",children:(0,i.jsx)(x.E.Label,{children:es.supporter})})]})]})})}),(0,i.jsxs)(h.r,{children:[(0,i.jsx)(h.r.Col,{span:{base:12,sm:12,md:4,lg:4},children:(0,i.jsxs)(u.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[O("common:points"),": ",ea]})}),(0,i.jsx)(h.r.Col,{span:{base:12,sm:12,md:4,lg:4},children:(0,i.jsx)(u.Z,{shadow:"sm",padding:"md",radius:"md",withBorder:!0,children:(0,i.jsxs)(d.Z,{align:"center",children:[(0,i.jsx)(k.i,{value:X,fractions:4,readOnly:!0,size:"lg"}),(0,i.jsx)(p.Text,{fw:"600",children:X.toFixed(2)})]})})})]})]}),(0,i.jsx)(b.i,{my:"xs",labelPosition:"left"}),(0,i.jsx)(h.r,{mt:"md",children:(0,i.jsx)(h.r.Col,{span:12,children:(0,i.jsxs)(u.Z,{padding:"xs",radius:"md",withBorder:!0,children:[(0,i.jsx)(u.Z.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:(0,i.jsx)(d.Z,{justify:"space-between",children:(0,i.jsx)(p.Text,{children:O("common:sorting.rating")})})}),(0,i.jsx)(k.i,{defaultValue:0,size:"lg",fractions:2,value:V,onChange:$,mt:"sm"}),(0,i.jsx)(v.z,{leftSection:(0,i.jsx)(C.Z,{size:14}),variant:"default",fullWidth:!0,mt:"md",radius:"md",onClick:ed,disabled:q,children:O("common:sorting.submit")})]})})})]})}},47025:(e,o,n)=>{"use strict";n.d(o,{$:()=>d});var i=n(2265),t=n(46027),s=n(90089),r=n(8358),a=n(64312),c=n(34583),l=n(70201);function d(e,o,n){let[t,a]=(0,r.fP)([l.YN]),c=(0,s.$G)(o,n),{i18n:d}=c;{let[o,n]=(0,i.useState)(d.resolvedLanguage);(0,i.useEffect)(()=>{o!==d.resolvedLanguage&&n(d.resolvedLanguage)},[d.resolvedLanguage]),(0,i.useEffect)(()=>{e&&d.resolvedLanguage!==e&&d.changeLanguage(e).then(()=>{n(e),a(l.YN,e,{path:"/"})})},[e,d,a])}return c}t.ZP.use(s.Db).use(c.Z).use((0,a.Z)((e,o)=>n(95700)("./".concat(e,"/").concat(o,".json")))).init({...(0,l.FW)(),lng:void 0,detection:{order:["path","htmlTag","cookie","navigator"]},preload:[]})},70201:(e,o,n)=>{"use strict";n.d(o,{FW:()=>a,Mj:()=>t,YN:()=>s});let i="zh-Hant",t=[i,"zh-Hant","zh-Hans"],s="i18next",r="translation";function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;return{supportedLngs:t,fallbackLng:i,lng:e,fallbackNS:r,defaultNS:r,ns:o}}},85393:(e,o,n)=>{"use strict";n.d(o,{default:()=>N});var i=n(57437),t=n(2265),s=n(56237),r=n(93059),a=n(86608),c=n(8244),l=n(20322),d=n(78178),m=n(7497),u=n(96293),h=n(34479),g=n(2638),j=n(84571),p=n(88477),f=n(98997),x=n(1597),k=n(91905),b=n(60399);function v(){let{colorScheme:e,toggleColorScheme:o}=(0,x.X)(),[n,s]=(0,t.useState)(()=>k.Z);return(0,t.useEffect)(()=>{s("dark"===e?b.Z:k.Z)},[e]),(0,i.jsx)(m.A,{variant:"default","aria-label":"Toggle theme",size:"lg",onClick:()=>o(),children:(0,i.jsx)(n,{style:{width:"80%",height:"80%"},stroke:1.5})})}var _=n(13866),w=n.n(_),y=n(16463),z=n(30998),Z=n(70201),C=n(47025);let S=e=>{let{opened:o,toggle:n,desktopOpened:t,toggleDesktop:s,lng:r}=e,x=(0,y.useRouter)(),k=(0,y.usePathname)(),{data:b,status:_}=(0,z.useSession)(),{t:S}=(0,C.$)(r,["common"]),E=e=>{x.push(e)},O=async()=>{await (0,z.signOut)({callbackUrl:"/"})},H=e=>{if(e===r)return;let o=k.split("/");Z.Mj.includes(o[1])?o[1]=e:o.splice(1,0,e);let n=o.join("/")||"/";x.push(n)};return(0,i.jsxs)("div",{className:w().inner,children:[(0,i.jsxs)(a.Z,{h:"100%",px:"md",children:[(0,i.jsx)(c.O,{opened:o,onClick:n,hiddenFrom:"sm",size:"sm"}),(0,i.jsx)(c.O,{opened:t,onClick:s,visibleFrom:"sm",size:"sm"}),(0,i.jsx)(g.Z,{style:{width:(0,l.h)(36),height:(0,l.h)(36)},stroke:1.5,color:"var(--mantine-color-red-filled)"}),(0,i.jsx)("div",{children:"Pokemon Nier"})]}),(0,i.jsx)("div",{className:w().actionIcon,children:(0,i.jsxs)(a.Z,{children:[(0,i.jsx)(v,{}),(0,i.jsxs)(d.v,{withArrow:!0,children:[(0,i.jsx)(d.v.Target,{children:(0,i.jsx)(m.A,{variant:"default",size:"lg","aria-label":"Language",children:(0,i.jsx)(j.Z,{})})}),(0,i.jsxs)(d.v.Dropdown,{children:[(0,i.jsx)(d.v.Label,{children:S("common:navigation.language_selection")}),(0,i.jsx)(d.v.Item,{onClick:()=>H("zh-Hans"),children:(0,i.jsx)(u.Text,{children:"简体中文"})}),(0,i.jsx)(d.v.Item,{onClick:()=>H("zh-Hant"),children:(0,i.jsx)(u.Text,{children:"繁體中文"})})]})]}),"loading"===_?(0,i.jsx)(m.A,{variant:"default",size:"lg","aria-label":"Loading",children:(0,i.jsx)(h.a,{color:"blue"})}):b?(0,i.jsx)(m.A,{variant:"default",size:"lg","aria-label":"Logout",onClick:O,children:(0,i.jsx)(p.Z,{})}):(0,i.jsx)(m.A,{variant:"default",size:"lg","aria-label":"Login",onClick:()=>E("/login"),children:(0,i.jsx)(f.Z,{})})]})})]})};var E=n(59223),O=n(70999),H=n(37341),R=n(55553),T=n(26804);let L=e=>{let{lng:o}=e,n=(0,y.useRouter)(),{data:t,status:s}=(0,z.useSession)(),{t:r}=(0,C.$)(o,["common"]),a=e=>{n.push(e)};return(0,i.jsxs)("nav",{children:[(0,i.jsx)(E.O,{component:"button",label:r("common:navigation.home"),leftSection:(0,i.jsx)(O.Z,{size:"1rem",stroke:1.5}),onClick:()=>a("/")}),(0,i.jsx)(E.O,{component:"button",label:r("common:navigation.cards"),leftSection:(0,i.jsx)(H.Z,{size:"1rem",stroke:1.5}),onClick:()=>a("/cards")}),(0,i.jsxs)(E.O,{component:"button",label:r("common:navigation.deck"),leftSection:(0,i.jsx)(R.Z,{size:"1rem",stroke:1.5}),children:[(0,i.jsx)(E.O,{label:r("common:navigation.deck_list"),onClick:()=>a("/decks/list")}),(0,i.jsx)(E.O,{label:r("common:navigation.create_deck"),onClick:()=>a("/decks/build")}),t&&(0,i.jsx)(E.O,{label:r("common:navigation.my_decks"),onClick:()=>a("/decks/user")})]}),(0,i.jsx)(E.O,{component:"button",label:r("common:navigation.about"),leftSection:(0,i.jsx)(T.Z,{size:"1rem",stroke:1.5}),onClick:()=>a("/about")})]})};function N(e){let{children:o,lng:n}=e,[t,{toggle:a}]=(0,r.q)(),[c,{toggle:l}]=(0,r.q)(!0);return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(s.V,{header:{height:60},navbar:{width:300,breakpoint:"sm",collapsed:{mobile:!t,desktop:!c}},padding:"md",children:[(0,i.jsx)(s.V.Header,{children:(0,i.jsx)(S,{opened:t,toggle:a,desktopOpened:c,toggleDesktop:l,lng:n})}),(0,i.jsx)(s.V.Navbar,{p:"md",children:(0,i.jsx)(L,{lng:n})}),(0,i.jsx)(s.V.Main,{children:o})]})})}},81822:(e,o,n)=>{"use strict";n.d(o,{D:()=>a,JG:()=>c,KH:()=>s,PZ:()=>t,l6:()=>r,pt:()=>i});let i={0:0,1:35,2:70,3:150,4:500,5:400,6:1250,7:1500,8:2500},t={0:"/common/grass.webp",1:"/common/fire.webp",2:"/common/water.webp",3:"/common/lightning.webp",4:"/common/psychic.webp",5:"/common/fighting.webp",6:"/common/darkness.webp",7:"/common/metal.webp",8:"/common/dragon.webp",9:"/common/colorless.webp"},s={grass:0,fire:1,water:2,lightning:3,psychic:4,fighting:5,darkness:6,metal:7,dragon:8,colorless:9},r={Common:1,Uncommon:2,Rare:3,DoubleRare:4,ArtRare:5,SuperRare:6,ImmersiveRare:7,UltraRare:8},a={pokemon:0,item:1,supporter:2},c={0:"",1:"/common/Common.webp",2:"/common/Uncommon.webp",3:"/common/Rare.webp",4:"/common/DoubleRare.webp",5:"/common/ArtRare.webp",6:"/common/SuperRare.webp",7:"/common/ImmersiveRare.webp",8:"/common/UltraRare.webp"}},13866:e=>{e.exports={inner:"Header_inner__BWOOt",link:"Header_link___GWEF",actionIcon:"Header_actionIcon__d8zIz"}}},e=>{var o=o=>e(e.s=o);e.O(0,[4977,5501,7337,8839,5588,5319,5948,2976,7235,5179,3497,7130,6215,1744],()=>o(34614)),_N_E=e.O()}]);