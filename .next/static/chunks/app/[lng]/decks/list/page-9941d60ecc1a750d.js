(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4125],{79822:(e,a,t)=>{Promise.resolve().then(t.bind(t,16968)),Promise.resolve().then(t.bind(t,46179))},16968:(e,a,t)=>{"use strict";t.d(a,{default:()=>Q});var o=t(57437),n=t(2265),l=t(1597),c=t(86608),s=t(99075),r=t(96293),i=t(22281),m=t(1959),d=t(41707),h=t(99763),u=t(41198),g=t(27260),p=t(7497),x=t(7662),b=t(91601),f=t(17750),j=t(11736),w=t(49309),v=t(70132),k=t(30269),C=t(9538),y=t(35671),_=t(69076),Z=t(83184),S=t(98557),z=t(85254),R=t(89056),A=t(34479),E=t(22966),L=t(29056),P=t(77967),O=t(54452),N=t(98953),T=t(62751),D=t(60912),M=t(32342),U=t(54310),I=t(18597),K=t(47834),F=t(11620),B=t(87138),H=t(30998),J=t(47025),G=t(60327),V=t(98179),W=t(35106),X=t(81822),$=t(16463),q=t(90089);let Q=e=>{let{lng:a}=e,{data:t}=(0,H.useSession)(),Q=(0,$.useSearchParams)(),{t:Y}=(0,J.$)(a,["pokemon","common","skill","ability","rule"]),[ee,ea]=(0,n.useState)([]),[et,eo]=(0,n.useState)(!0),[en,el]=(0,n.useState)(0),[ec,es]=(0,n.useState)("createdAt"),[er,ei]=(0,n.useState)("desc"),{colorScheme:em}=(0,l.X)(),[ed,eh]=(0,n.useState)("#228be6"),[eu,eg]=(0,n.useState)("red");(0,n.useEffect)(()=>{"dark"===em?(eh("white"),eg("white")):(eh("#228be6"),eg("red"))},[em]);let[ep,ex]=(0,W.Z)("searchTerm",""),[eb,ef]=(0,n.useState)([]),[ej,ew]=(0,n.useState)([]),[ev,ek]=(0,W.Z)("isFilterOpenList",!1),[eC,ey]=(0,W.Z)("selectedSetsList",[]),[e_,eZ]=(0,W.Z)("selectedDexsList",[]),[eS,ez]=(0,W.Z)("selectedAspectsList",[]),[eR,eA]=(0,W.Z)("selectedRarityList",[]),[eE,eL]=(0,W.Z)("selectedTypeList",[]),[eP,eO]=(0,W.Z)("selectedWeaknessList",[]),[eN,eT]=(0,W.Z)("selectedRetreatList",[]),[eD,eM]=(0,W.Z)("hpRangeList",[0,250]),[eU,eI]=(0,W.Z)("attackRangeList",[0,250]),[eK,eF]=(0,n.useState)(""),[eB,eH]=(0,n.useState)(20),eJ=["A1","PROMO-A"].map(e=>({value:e,label:"(".concat(e,")").concat(Y("common:cardSet.".concat(e)))})),eG=(0,n.useMemo)(()=>{let e=new Set;return eC.forEach(a=>{X.x9[a].forEach(a=>e.add(a))}),Array.from(e).map(e=>({value:e,label:"(".concat(e,")").concat(Y("common:cardDex.".concat(e)))}))},[eC,Y]);(0,n.useEffect)(()=>{let e=eG.map(e=>e.value),a=e_.filter(a=>e.includes(a));a.length!==e_.length&&eZ(a)},[eG,e_,eZ]);let eV=["grass","fire","water","lightning","psychic","fighting","darkness","metal","dragon","colorless"].map(e=>({value:e,label:"".concat(Y("common:".concat(e)))})),eW=["Common","Uncommon","Rare","DoubleRare","ArtRare","SuperRare","ImmersiveRare","UltraRare"].map(e=>({value:e,label:"".concat(Y("common:".concat(e)))})),eX=["pokemon","item","supporter"].map(e=>({value:e,label:"".concat(Y("common:".concat(e)))})),e$=["1","2","3","4","5"].map(e=>({value:e,label:e})),eq=async e=>{try{let a=e.length>0?"?sets=".concat(e.join(",")):"",t=await fetch("/api/card".concat(a));if(!t.ok)throw Error("無法取得卡片資料。");let o=await t.json();ew(o)}catch(e){ew([])}};(0,n.useEffect)(()=>{0===eC.length?(ew([]),ef([])):eq(eC)},[eC]),(0,n.useEffect)(()=>{let e=ej;if(ep){let a=ep.toLowerCase();e=e.filter(e=>Y("pokemon:".concat(e.name)).toLowerCase().includes(a)||Y("skill:".concat(e.attack_name_1,".name")).toLowerCase().includes(a)||Y("skill:".concat(e.attack_name_1,".description")).toLowerCase().includes(a)||Y("skill:".concat(e.attack_name_2,".name")).toLowerCase().includes(a)||Y("skill:".concat(e.attack_name_2,".description")).toLowerCase().includes(a)||Y("ability:".concat(e.ability_name,".name")).toLowerCase().includes(a)||Y("ability:".concat(e.ability_name,".description")).toLowerCase().includes(a))}if(eC.length>0&&(e=e.filter(e=>eC.includes(e.set))),e_.length>0&&(e=e.filter(e=>e.dex.some(e=>e_.includes(e)))),eS.length>0){let a=eS.map(e=>X.KH[e]).filter(e=>"number"==typeof e);e=e.filter(e=>a.includes(e.aspects))}if(eR.length>0){let a=eR.map(e=>X.l6[e]).filter(e=>"number"==typeof e);e=e.filter(e=>a.includes(e.rarity))}if(eE.length>0){let a=eE.map(e=>X.D[e]).filter(e=>"number"==typeof e);e=e.filter(e=>a.includes(e.type))}if(eP.length>0){let a=eP.map(e=>X.KH[e]).filter(e=>"number"==typeof e);e=e.filter(e=>a.includes(e.weakness))}if(eN.length>0){let a=eN.map(e=>Number(e)).filter(e=>!isNaN(e));e=e.filter(e=>a.includes(e.retreat))}ef(e=(e=e.filter(e=>e.hp>=eD[0]&&e.hp<=eD[1])).filter(e=>e.attack_1>=eU[0]&&e.attack_1<=eU[1]||null!=e.attack_2&&e.attack_2>=eU[0]&&e.attack_2<=eU[1])),eH(20)},[ej,ep,eC,e_,eS,eR,eE,eP,eN,eD,eU]);let eQ=e=>{let{option:a}=e;return(0,o.jsxs)(c.Z,{gap:"sm",children:[(0,o.jsx)(s.E,{src:"/common/".concat(a.value,".webp"),alt:Y("common:".concat(a.value)),height:20,width:20}),(0,o.jsx)(r.Text,{size:"sm",children:Y("common:".concat(a.value))})]})};(0,n.useEffect)(()=>{let e=Q.get("selectedCard");e?eF(e):eF("")},[Q]);let eY=async(e,a)=>{try{let t=new URL("/api/decks/list",window.location.origin);"usageCount"===ec&&(t=new URL("/api/decks/list/usage",window.location.origin)),"averageRating"===ec&&(t=new URL("/api/decks/list/rating",window.location.origin)),t.searchParams.append("limit","10"),null!==a?t.searchParams.append("cursor",a.toString()):t.searchParams.append("cursor",en.toString()),t.searchParams.append("sortBy",ec),t.searchParams.append("sortOrder",er),null!==e?t.searchParams.append("card",e):t.searchParams.append("card",eK);let o=await fetch(t.toString());if(!o.ok)throw Error("Failed to fetch decks");let n=await o.json(),l=n.decks.map(e=>e.id);new Set(l).size!==l.length&&console.warn("Duplicate deck IDs found in the response:",l),ea(e=>{let t=null!==a?n.decks:[...e,...n.decks],o=new Map;return t.forEach(e=>{o.set(e.id,e)}),Array.from(o.values())}),el(n.nextCursor),eo(!n.endCursor)}catch(e){console.error("Error fetching decks:",e),(0,G.c0)({title:Y("common:error"),message:Y("common:failedToFetchDecks"),color:"red"})}};(0,n.useEffect)(()=>{let e=Q.get("selectedCard");el(0),eY(e,0)},[]);let e0=e=>e.split(",").map(e=>{let a=e.lastIndexOf("-");return -1===a?{set:e.trim(),number:""}:{set:e.substring(0,a).trim(),number:e.substring(a+1).trim()}}),e1=async e=>{if(!(null==t?void 0:t.user)){(0,G.c0)({title:Y("common:notification.error_not_logged_in"),message:Y("common:notification.error_please_login"),color:"red",icon:(0,o.jsx)(E.Z,{size:16})});return}try{let a=await fetch("/api/decks/".concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({deckName:Y("common:notification.notification_unnamed")})}),t=await a.json();a.ok?((0,G.c0)({title:Y("common:notification.success"),message:Y("common:notification.success_deck_saved"),color:"green",icon:(0,o.jsx)(L.Z,{size:16})}),ea(a=>a.map(a=>a.id===e?{...a,isSaved:!0,usageCount:a.usageCount+1}:a))):(0,G.c0)({title:Y("common:notification.error"),message:t.message||Y("common:notification.error_save_deck_failed"),color:"red",icon:(0,o.jsx)(E.Z,{size:16})})}catch(e){(0,G.c0)({title:Y("common:notification.error"),message:Y("common:notification.error_save_deck"),color:"red",icon:(0,o.jsx)(E.Z,{size:16})})}finally{}},e2=async e=>{if(!(null==t?void 0:t.user)){(0,G.c0)({title:Y("common:notification.error_not_logged_in"),message:Y("common:notification.error_please_login"),color:"red",icon:(0,o.jsx)(E.Z,{size:16})});return}try{let a=await fetch("/api/decks/".concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"}}),t=await a.json();a.ok?((0,G.c0)({title:Y("common:notification.success"),message:Y("common:notification.success_deck_deleted"),color:"green",icon:(0,o.jsx)(L.Z,{size:16})}),ea(a=>a.map(a=>a.id===e?{...a,isSaved:!1,usageCount:a.usageCount-1}:a))):(0,G.c0)({title:Y("common:notification.error_title"),message:t.message||Y("common:notification.error_delete_deck_failed"),color:"red",icon:(0,o.jsx)(E.Z,{size:16})})}catch(e){(0,G.c0)({title:Y("common:notification.error_title"),message:Y("common:notification.error_delete_deck"),color:"red",icon:(0,o.jsx)(E.Z,{size:16})})}finally{}},e5=[{title:Y("common:navigation.home"),href:"/"},{title:Y("common:navigation.deck_list"),href:"#"}].map((e,a)=>(0,o.jsx)(i.e,{href:e.href,children:e.title},a)),e6=(0,o.jsx)(P.Z,{});return(0,o.jsxs)(m.W,{size:"lg",children:[(0,o.jsx)(d.O,{children:e5}),(0,o.jsx)(h.Title,{order:1,mt:"sm",children:Y("common:navigation.deck_list")}),(0,o.jsx)(u.V,{color:"blue",icon:e6,mt:"xl",children:(0,o.jsx)(r.Text,{children:(0,o.jsx)(q.cC,{i18nKey:"common:filterInstruction",components:[(0,o.jsx)(O.Z,{size:18}),(0,o.jsx)(N.Z,{size:18})]})})}),(0,o.jsxs)(c.Z,{align:"center",justify:"space-between",mb:"md",mt:"md",children:[(0,o.jsx)(g.N,{placeholder:Y("common:set"),data:eJ,searchable:!0,clearable:!0,value:eC,onChange:ey,maxValues:1}),(0,o.jsxs)(c.Z,{children:[(0,o.jsx)(p.A,{variant:"default",size:"lg",onClick:()=>{eZ([]),ez([]),eA([]),eL([]),eO([]),eT([]),ex(""),eM([0,250]),eI([0,250]),eF("")},children:(0,o.jsx)(T.Z,{})}),(0,o.jsx)(p.A,{variant:"default",size:"lg",onClick:()=>ek(!ev),children:(0,o.jsx)(O.Z,{})})]})]}),(0,o.jsxs)(x.U,{in:ev,children:[(0,o.jsx)(b.i,{my:"xs",label:Y("common:advancedFiltering"),labelPosition:"left"}),(0,o.jsxs)(f.x,{mb:"md",children:[(0,o.jsx)(c.Z,{children:(0,o.jsx)(j.o,{placeholder:Y("common:search_card"),value:ep,onChange:e=>ex(e.target.value),leftSection:(0,o.jsx)(D.Z,{size:16}),radius:"md",size:"md",styles:{input:{width:300}}})}),(0,o.jsxs)(w.r,{mb:"md",children:[(0,o.jsx)(w.r.Col,{span:4,children:(0,o.jsx)(g.N,{label:Y("common:dex"),placeholder:Y("common:dex"),data:eG,searchable:!0,clearable:!0,value:e_,onChange:eZ})}),(0,o.jsx)(w.r.Col,{span:4,children:(0,o.jsx)(g.N,{label:Y("common:aspects"),placeholder:Y("common:aspects"),data:eV,clearable:!0,renderOption:eQ,value:eS,onChange:ez})}),(0,o.jsx)(w.r.Col,{span:4,children:(0,o.jsx)(g.N,{label:Y("common:rarity"),placeholder:Y("common:rarity"),data:eW,clearable:!0,renderOption:e=>{let{option:a}=e;return(0,o.jsxs)(c.Z,{gap:"sm",children:[(0,o.jsx)(s.E,{src:"/common/".concat(a.value,".webp"),alt:Y("common:".concat(a.value)),height:20,width:20}),(0,o.jsx)(r.Text,{size:"sm",children:Y("common:".concat(a.value))})]})},value:eR,onChange:eA})})]}),(0,o.jsxs)(w.r,{mb:"md",children:[(0,o.jsx)(w.r.Col,{span:4,children:(0,o.jsx)(g.N,{label:Y("common:type"),placeholder:Y("common:type"),data:eX,clearable:!0,value:eE,onChange:eL})}),(0,o.jsx)(w.r.Col,{span:4,children:(0,o.jsx)(g.N,{label:Y("common:weakness"),placeholder:Y("common:weakness"),data:eV,clearable:!0,renderOption:eQ,value:eP,onChange:eO})}),(0,o.jsx)(w.r.Col,{span:4,children:(0,o.jsx)(g.N,{label:Y("common:retreat"),placeholder:Y("common:retreat"),data:e$,clearable:!0,value:eN,onChange:eT})})]}),(0,o.jsxs)(w.r,{mb:"md",gutter:"md",children:[(0,o.jsx)(w.r.Col,{span:{base:12,sm:6,md:6},mt:"sm",mb:"md",children:(0,o.jsx)(v.K,{children:(0,o.jsx)(k.U,{min:0,max:250,value:eD,onChange:eM,marks:[{value:0,label:"0"},{value:50,label:"50"},{value:100,label:"100"},{value:150,label:"150"},{value:200,label:"200"},{value:250,label:"250"}],"aria-label":Y("common:hp_range"),thumbSize:26,thumbChildren:[(0,o.jsx)(M.Z,{size:"1rem",color:eu},"1"),(0,o.jsx)(M.Z,{size:"1rem",color:eu},"2")],color:"red"})})}),(0,o.jsx)(w.r.Col,{span:{base:12,sm:6,md:6},mt:"sm",mb:"md",children:(0,o.jsx)(v.K,{children:(0,o.jsx)(k.U,{min:0,max:250,value:eU,onChange:eI,marks:[{value:0,label:"0"},{value:50,label:"50"},{value:100,label:"100"},{value:150,label:"150"},{value:200,label:"200"},{value:250,label:"250"}],"aria-label":Y("common:attack_range"),thumbSize:26,thumbChildren:[(0,o.jsx)(U.Z,{size:"1rem",color:ed},"3"),(0,o.jsx)(U.Z,{size:"1rem",color:ed},"4")]})})})]})]}),(0,o.jsx)(C.x,{h:440,scrollbars:"y",mt:"md",id:"scrollableDiv",children:(0,o.jsxs)(f.x,{mt:"md",h:610,children:[(0,o.jsx)(w.r,{mt:"md",columns:10,children:eb.slice(0,eB).map(e=>(0,o.jsx)(w.r.Col,{span:{base:5,sm:2,md:2,lg:2},children:(0,o.jsxs)(y.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,onClick:()=>eF(eK===e.number?"":e.number),style:{cursor:"pointer",filter:eK&&eK!==e.number?"grayscale(100%)":"none"},children:[(0,o.jsx)(y.Z.Section,{children:(0,o.jsx)(s.E,{src:"/".concat(a,"/").concat(e.set,"/").concat(e.number,".webp"),alt:Y("pokemon:".concat(e.name)),loading:"lazy"})}),(0,o.jsxs)(v.K,{mt:"md",align:"center",gap:"xs",children:[(0,o.jsx)(r.Text,{fw:700,size:"lg",children:Y("pokemon:".concat(e.name))}),(0,o.jsx)(r.Text,{c:"dimmed",size:"sm",children:e.number}),(0,o.jsxs)(_.k,{gap:"xs",justify:"center",wrap:"wrap",children:[(0,o.jsx)(Z.C,{color:"blue",variant:"light",children:Y("common:cardSet.".concat(e.set))}),e.dex.filter(e=>"NO"!==e).map((e,a)=>(0,o.jsx)(Z.C,{color:"green",variant:"outline",children:Y("common:cardDex.".concat(e))},a))]})]})]})},e.id))}),eB<eb.length&&(0,o.jsx)(S.M,{mt:"md",children:(0,o.jsx)(z.z,{onClick:()=>{eH(e=>e+20)},children:"載入更多"})})]})})]}),(0,o.jsx)(b.i,{my:"xs",label:Y("common:navigation.deck_list"),labelPosition:"left"}),(0,o.jsxs)(_.k,{mt:"md",align:"flex-end",gap:"md",children:[(0,o.jsx)(R.P,{label:Y("common:sorting.sortingMode"),placeholder:Y("common:sorting.chooseSortingMode"),data:[{value:"averageRating",label:Y("common:sorting.rating")},{value:"usageCount",label:Y("common:sorting.favorite")},{value:"createdAt",label:Y("common:sorting.creationTime")}],value:ec,onChange:e=>{null!==e&&es(e)},style:{width:200}}),(0,o.jsx)(R.P,{label:Y("common:sorting.sortingOrder"),placeholder:Y("common:sorting.chooseSortingOrder"),data:[{value:"desc",label:Y("common:sorting.descendingNewest")},{value:"asc",label:Y("common:sorting.ascendingOldest")}],value:er,onChange:e=>{null!==e&&ei(e)},style:{width:200}}),(0,o.jsxs)(z.z,{onClick:()=>{ea([]),el(0),eo(!0),eY(null,0)},style:{height:36},children:[(0,o.jsx)(N.Z,{}),Y("common:sorting.submit")]})]}),(0,o.jsx)(V.Z,{dataLength:ee.length,next:()=>{eY(null,null)},hasMore:et,loader:(0,o.jsx)(S.M,{mt:"md",children:(0,o.jsx)(A.a,{})}),endMessage:(0,o.jsx)(o.Fragment,{}),style:{width:"100%",overflow:"hidden"},children:(0,o.jsx)(w.r,{mt:"md",children:ee.map(e=>(0,o.jsx)(w.r.Col,{children:(0,o.jsxs)(y.Z,{shadow:"sm",padding:"lg",radius:"md",withBorder:!0,children:[(0,o.jsx)(y.Z.Section,{withBorder:!0,inheritPadding:!0,py:"xs",children:(0,o.jsxs)(c.Z,{style:{marginBottom:5},justify:"space-between",children:[(0,o.jsx)(h.Title,{order:4,children:e.id}),(0,o.jsxs)(c.Z,{children:[(0,o.jsx)(I.Z,{color:"#fcc419"}),(0,o.jsx)(r.Text,{fw:500,children:e.averageRating.toFixed(2)}),e.isSaved?(0,o.jsx)(p.A,{variant:"default",size:"lg",onClick:()=>e2(e.id),children:(0,o.jsx)(K.Z,{color:"#fcc419"})}):(0,o.jsx)(p.A,{variant:"default",size:"lg",onClick:()=>e1(e.id),children:(0,o.jsx)(F.Z,{color:"#fcc419"})}),(0,o.jsx)(r.Text,{fw:500,children:e.usageCount})]})]})}),(0,o.jsx)(B.default,{href:"/decks/".concat(e.id),passHref:!0,style:{textDecoration:"none"},children:(0,o.jsx)(w.r,{columns:10,mt:"md",children:e0(e.deckCards).map((t,n)=>(0,o.jsx)(w.r.Col,{span:{base:2,sm:2,md:1,lg:1},children:(0,o.jsx)(s.E,{radius:"md",src:"/".concat(a,"/").concat(t.set,"/").concat(t.set,"-").concat(t.number,".webp"),alt:"".concat(t.set,"-").concat(t.number),loading:"lazy"})},"".concat(e.id,"-").concat(t.set,"-").concat(t.number,"-").concat(n)))})})]})},e.id))})})]})}},81822:(e,a,t)=>{"use strict";t.d(a,{D:()=>r,Gg:()=>d,JG:()=>i,KH:()=>c,Nr:()=>m,PZ:()=>l,RP:()=>h,l6:()=>s,pt:()=>n,x9:()=>o});let o={A1:["A1C","A1M","A1P"],"PROMO-A":[]},n={0:0,1:35,2:70,3:150,4:500,5:400,6:1250,7:1500,8:2500},l={0:"/common/grass.webp",1:"/common/fire.webp",2:"/common/water.webp",3:"/common/lightning.webp",4:"/common/psychic.webp",5:"/common/fighting.webp",6:"/common/darkness.webp",7:"/common/metal.webp",8:"/common/dragon.webp",9:"/common/colorless.webp"},c={grass:0,fire:1,water:2,lightning:3,psychic:4,fighting:5,darkness:6,metal:7,dragon:8,colorless:9},s={Common:1,Uncommon:2,Rare:3,DoubleRare:4,ArtRare:5,SuperRare:6,ImmersiveRare:7,UltraRare:8},r={pokemon:0,item:1,supporter:2},i={0:"",1:"/common/Common.webp",2:"/common/Uncommon.webp",3:"/common/Rare.webp",4:"/common/DoubleRare.webp",5:"/common/ArtRare.webp",6:"/common/SuperRare.webp",7:"/common/ImmersiveRare.webp",8:"/common/UltraRare.webp"},m={0:[0,0,0],1:[100,0,0],2:[0,90,60],3:[0,5,20],4:[0,1.666,6.664],5:[0,2.572,10.288],6:[0,.5,2],7:[0,.222,.888],8:[0,.04,.16]},d={A1C:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[40,40,40],[50,50,50],[5,5,5],[5,5,5]],A1M:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[42.105,42.105,42.105],[47.368,47.368,47.368],[5.263,5.263,5.263],[5.263,5.263,5.263]],A1P:[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[40,40,40],[50,50,50],[5,5,5],[5,5,5]]},h={A1C:"red",A1M:"purple",A1P:"yellow"}},35106:(e,a,t)=>{"use strict";t.d(a,{Z:()=>n});var o=t(2265);let n=function(e,a){let[t,n]=(0,o.useState)(a);return(0,o.useEffect)(()=>{try{let a=localStorage.getItem(e);a&&n(JSON.parse(a))}catch(a){console.error('Error reading localStorage key "'.concat(e,'":'),a)}},[e]),[t,a=>{try{n(a),localStorage.setItem(e,JSON.stringify(a))}catch(a){console.error('Error setting localStorage key "'.concat(e,'":'),a)}}]}}},e=>{var a=a=>e(e.s=a);e.O(0,[7646,5501,8839,1141,5948,2008,7235,9498,5179,9219,3966,6179,7130,6215,1744],()=>a(79822)),_N_E=e.O()}]);