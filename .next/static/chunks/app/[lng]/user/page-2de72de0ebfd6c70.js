(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7952],{21931:(e,o,n)=>{Promise.resolve().then(n.bind(n,48924)),Promise.resolve().then(n.bind(n,46179))},48924:(e,o,n)=>{"use strict";n.d(o,{default:()=>x});var t=n(57437),i=n(2265),s=n(22281),r=n(1959),a=n(98557),m=n(96293),c=n(41707),l=n(99763),d=n(17750),h=n(11736),u=n(85254),f=n(87138),g=n(47025),p=n(16463),_=n(30998),j=n(60327);let x=e=>{let{lng:o}=e,{data:n}=(0,_.useSession)(),{t:x}=(0,g.$)(o,["common"]),v=(0,p.useRouter)(),[b,k]=(0,i.useState)(""),[y,w]=(0,i.useState)(""),[C,S]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(async()=>{if(n)try{let e=await fetch("/api/user/getUser"),o=await e.json();e.ok&&(k(o.user.name),w(o.user.pokemonId))}catch(e){}})()},[n]);let O=async()=>{S(!0);try{let e=await fetch("/api/user/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:b,pokemonId:y})}),o=await e.json();e.ok?((0,j.c0)({title:x("common:notification.success"),message:x("common:notification.update_success"),color:"green"}),v.refresh()):(0,j.c0)({title:x("common:notification.error_title"),message:o.error||x("common:notification.update_failed"),color:"red"})}catch(e){console.error("更新失败:",e),(0,j.c0)({title:x("common:notification.error_title"),message:x("common:notification.update_failed"),color:"red"})}finally{S(!1)}},E=[{title:x("common:navigation.home"),href:"/"},{title:x("common:navigation.member_settings"),href:"#"}].map((e,o)=>(0,t.jsx)(s.e,{href:e.href,children:e.title},o));return(0,t.jsx)(r.W,{size:"lg",children:(null==n?void 0:n.user)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.O,{children:E}),(0,t.jsx)(l.Title,{order:1,mt:"sm",children:x("common:navigation.member_settings")}),(0,t.jsxs)(d.x,{mt:"md",children:[(0,t.jsx)(h.o,{label:x("common:name"),placeholder:x("common:enter_name"),value:b,onChange:e=>k(e.target.value),required:!0,mb:"sm"}),(0,t.jsx)(h.o,{label:x("common:pokemon_id"),placeholder:x("common:enter_pokemon_id"),value:y,onChange:e=>w(e.target.value),mb:"sm"}),(0,t.jsx)(u.z,{onClick:O,loading:C,disabled:C,children:x("common:save_changes")})]})]}):(0,t.jsx)(a.M,{children:(0,t.jsxs)(m.Text,{children:[x("common:errors.error_insufficient_permissions")," ",(0,t.jsx)(s.e,{component:f.default,href:"/login",size:"sm",children:x("common:login.login")})]})})})}}},e=>{var o=o=>e(e.s=o);e.O(0,[7646,5501,8839,1141,5948,2008,7235,9498,9622,6179,7130,6215,1744],()=>o(21931)),_N_E=e.O()}]);